version: 2
jobs:
  build:
    docker:
      - image: alanz/hare-ci
    steps:
      - checkout
      - restore_cache:
          key: stack-cache
          paths:
            - .stack
            - .cache
      - run: stack -j 2 --stack-yaml=stack-8.2.2.yaml setup
      - run: stack -j 2 --stack-yaml=stack-8.2.2.yaml test --no-run-tests
      - save_cache:
          key: stack-cache
          paths:
            - .stack
            - .cache
      - run: stack -j 2 --stack-yaml=stack-8.2.2.yaml test
      - save_cache:
          key: stack-cache
          paths:
            - .stack
            - .cache
